let pokemonRepository=function(){const origPokemonList=[];let workingPokemonList=[];const dataLength=150,apiURL="https://pokeapi.co/api/v2/pokemon/?limit=150";let pokemonPos=null;const pokemonDIV=document.querySelector(".pokemons"),modalHeader=document.querySelector(".modal-header button"),modalBody=document.querySelector(".modal-body"),modalPrevButton=document.querySelector("#prevPokeBtn"),modalNextButton=document.querySelector("#nextPokeBtn"),loader=document.querySelector(".loader"),modalLoader=document.querySelector(".modal-loader-div"),loadList=()=>fetch(apiURL).then((function(response){return response.json()})).then((function(json){json.results.forEach((function(item){let pokemon={name:item.name,detailsUrl:item.url};add(pokemon)})),toggleLoader()})).catch((function(){alert("Not able load Pokemon's right now. Please try again later")})),toggleLoader=()=>{pokemonDIV.classList.toggle("hide"),loader.classList.toggle("hide")},toggleModalLoader=()=>{modalLoader.classList.toggle("hide")},getAll=()=>origPokemonList,add=newPokemon=>{if("object"!=typeof newPokemon)alert("Error processing Pokemon's. Please try again later");else{const requiredPokemonKeys={name:"",detailsUrl:""};Object.keys(newPokemon).every(element=>element in requiredPokemonKeys)?origPokemonList.push(newPokemon):alert("Error processing Pokemon's. Please try again later")}workingPokemonList=origPokemonList},clearModal=()=>{const modalTitle=document.querySelector(".modal-title");void 0!==modalTitle&&null!=modalTitle&&modalTitle.parentNode.removeChild(modalTitle),modalBody.innerHTML="",modalNextButton.removeEventListener("click",loadNavigatedPokemon),modalPrevButton.removeEventListener("click",loadNavigatedPokemon)},populateModal=pokemon=>{pokemonPos=workingPokemonList.map(i=>i.name).indexOf(pokemon.name);const capPokemonName=pokemon.name.charAt(0).toUpperCase()+pokemon.name.slice(1),pokemonHeading=document.createElement("h5");pokemonHeading.classList.add("modal-title","w-100","text-center"),pokemonHeading.setAttribute("id","modalHeader"),pokemonHeading.setAttribute("alt",`You have loaded ${capPokemonName}">${capPokemonName}</h5>`),pokemonHeading.innerText=capPokemonName,modalHeader.before(pokemonHeading);const pokemonImg=document.createElement("img");pokemonImg.setAttribute("src",pokemon.imageURL),pokemonImg.setAttribute("id","pokemon-image"),pokemonImg.setAttribute("alt",`The ${capPokemonName} Pokemon`),pokemonImg.addEventListener("load",()=>{toggleModalLoader()}),modalBody.appendChild(pokemonImg);const pokemonDetails=document.createElement("p");pokemonDetails.innerText=`${capPokemonName} is ${pokemon.height}m tall`,modalBody.appendChild(pokemonDetails);const pokemonTypes=document.createElement("p");pokemon.types.forEach((p,index)=>{pokemonTypes.classList.add("types"),index<1&&(pokemon.types.length>1?pokemonTypes.innerText="Types are: ":pokemonTypes.innerText="Type is: "),pokemonTypes.innerText+=index<1?p.type.name:`, ${p.type.name}`}),modalBody.appendChild(pokemonTypes),pokemonPos>0?(modalPrevButton.removeAttribute("disabled"),modalPrevButton.addEventListener("click",loadNavigatedPokemon)):modalPrevButton.setAttribute("disabled",!0),pokemonPos<workingPokemonList.length-1?(modalNextButton.removeAttribute("disabled"),modalNextButton.addEventListener("click",loadNavigatedPokemon)):modalNextButton.setAttribute("disabled",!0)},addListItem=pokemon=>{let pokemonButton=document.createElement("button");pokemonButton.innerText=pokemon.name,pokemonButton.classList.add("btn","btn-primary","btn-lg","mb-1","ripple"),pokemonButton.setAttribute("data-toggle","modal"),pokemonButton.setAttribute("data-target","#pokemonModal"),pokemonDIV.appendChild(pokemonButton)};function clearListItems(){pokemonDIV.innerHTML=""}const findPokemon=pokemonToFind=>{let pokemonSearchTerm=pokemonToFind.toLowerCase(),searchResult=workingPokemonList.find(pokemon=>pokemon.name===pokemonSearchTerm);return void 0!==searchResult?searchResult:null},loadDetails=item=>{let url=item.detailsUrl;return fetch(url).then((function(response){return response.json()})).then((function(details){item.imageURL=details.sprites.front_default,item.height=details.height,item.types=details.types})).catch((function(){alert("Not able to retrieve details about this Pokemon right now")}))},loadNavigatedPokemon=({target:target})=>{let pokemonToLoad=null;clearModal(),toggleModalLoader(),pokemonToLoad="nextPokeBtn"===target.id?workingPokemonList[pokemonPos+1]:workingPokemonList[pokemonPos-1],loadDetails(pokemonToLoad).then(()=>{populateModal(pokemonToLoad)}).catch(()=>{alert("Not able to retrieve details about this Pokemon right now")})},resetWorkingPokemonList=filteredArr=>{workingPokemonList=filteredArr};return{getAll:getAll,addListItem:addListItem,clearListItems:clearListItems,loadList:loadList,findPokemon:findPokemon,loadDetails:loadDetails,populateModal:populateModal,toggleModalLoader:toggleModalLoader,resetWorkingPokemonList:resetWorkingPokemonList,clearModal:clearModal}}();pokemonRepository.loadList().then((function(){pokemonRepository.getAll().forEach(pokemon=>{pokemonRepository.addListItem(pokemon)})})),$("#pokemonModal").on("show.bs.modal",({relatedTarget:relatedTarget})=>{let pokemon=null;pokemon=pokemonRepository.findPokemon(relatedTarget.innerText),pokemonRepository.loadDetails(pokemon).then(()=>{pokemonRepository.populateModal(pokemon)}).catch(()=>{alert("Not able to retrieve details about this Pokemon right now")})}),$("#pokemonModal").on("hidden.bs.modal",(function(){pokemonRepository.clearModal(),pokemonRepository.toggleModalLoader()})),document.querySelector("#searchTerm").addEventListener("input",()=>{pokemonRepository.clearListItems();const searchTerm=document.querySelector("#searchTerm").value,filteredSearch=pokemonRepository.getAll().filter(pokemon=>pokemon.name.indexOf(searchTerm)>-1);filteredSearch.forEach(pokemon=>pokemonRepository.addListItem(pokemon)),pokemonRepository.resetWorkingPokemonList(filteredSearch)});